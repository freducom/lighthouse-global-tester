<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Statistics - CheetahCheck</title>
    <meta name="description" content="Comprehensive statistics and analytics for CheetahCheck's global website performance monitoring across 1016 websites in 70 countries.">
    
    <link rel="stylesheet" href="styles.css">
        <link rel="icon" type="image/png" sizes="16x16" href="cheetahcheck_favicon_16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="cheetahcheck_favicon_32x32.png">
    <link rel="icon" type="image/png" sizes="48x48" href="cheetahcheck_favicon_48x48.png">
    <link rel="icon" type="image/png" sizes="64x64" href="cheetahcheck_favicon_64x64.png">
    <link rel="icon" type="image/png" sizes="128x128" href="cheetahcheck_favicon_128x128.png">
    <link rel="icon" type="image/png" sizes="256x256" href="cheetahcheck_favicon_256x256.png">
    <link rel="apple-touch-icon" sizes="128x128" href="cheetahcheck_favicon_128x128.png">
    <link rel="apple-touch-icon" sizes="256x256" href="cheetahcheck_favicon_256x256.png">
        <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="CheetahCheck">
    <meta name="mobile-web-app-capable" content="yes">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        
        <header class="header" role="banner">
            <div class="logo-container">
                <a href="index.html"><img src="logo.png" alt="CheetahCheck" class="header-logo"></a>
            </div>
            <p class="subtitle">Performance Statistics</p>
            <p class="back-to-frontpage"><a href="index.html">‚Üê Back to frontpage</a></p>
        </header>
    
        <main class="container">

            <!-- Global Overview Stats (Real Data) -->
            <section class="stats-grid">
                <div class="stat-tile">
                    <div class="stat-icon">üåê</div>
                    <div class="stat-content">
                        <div class="stat-number">1016</div>
                        <div class="stat-label">Total Websites</div>
                    </div>
                </div>
                
                <div class="stat-tile">
                    <div class="stat-icon">üè¥Û†Åø</div>
                    <div class="stat-content">
                        <div class="stat-number">70</div>
                        <div class="stat-label">Countries</div>
                    </div>
                </div>
                
                <div class="stat-tile">
                    <div class="stat-icon">üè≠</div>
                    <div class="stat-content">
                        <div class="stat-number">50</div>
                        <div class="stat-label">Industries</div>
                    </div>
                </div>
                
                <div class="stat-tile">
                    <div class="stat-icon">‚ö°</div>
                    <div class="stat-content">
                        <div class="stat-number">45</div>
                        <div class="stat-label">Avg Performance</div>
                    </div>
                </div>
            </section>

            <!-- Performance Distribution (Real Data) -->
            <section class="chart-section">
                <h2>Performance Score Distribution</h2>
                <p class="chart-description">Real distribution from 1016 tested websites</p>
                <div class="performance-distribution">
                    <div class="perf-category excellent">
                        <div class="perf-number">28</div>
                        <div class="perf-label">Excellent (90+)</div>
                        <div class="perf-percentage">3%</div>
                    </div>
                    <div class="perf-category good">
                        <div class="perf-number">340</div>
                        <div class="perf-label">Good (50-89)</div>
                        <div class="perf-percentage">33%</div>
                    </div>
                    <div class="perf-category poor">
                        <div class="perf-number">648</div>
                        <div class="perf-label">Poor (0-49)</div>
                        <div class="perf-percentage">64%</div>
                    </div>
                </div>
            </section>

            <!-- Top Industries Performance (Real Data) -->
            <section class="chart-section">
                <h2>üè≠ Top Industries by Performance</h2>
                <p class="chart-description">Real industry performance averages from tested websites</p>
                <div class="chart-container">
                    <canvas id="topIndustriesChart"></canvas>
                </div>
            </section>

            <!-- Top Countries Performance (Real Data) -->
            <section class="chart-section">
                <h2>üåç Top Countries by Performance</h2>
                <p class="chart-description">Leading countries in web performance scores</p>
                <div class="chart-container">
                    <canvas id="topCountriesChart"></canvas>
                </div>
            </section>

            <!-- Industry Benchmarking (Real Data) -->
            <section class="chart-section">
                <h2>üéØ Industry Benchmarking</h2>
                <p class="chart-description">Top 5 industries by number of domains tested - showing performance across all metrics</p>
                <div class="chart-container">
                    <canvas id="industryBenchmarkChart"></canvas>
                </div>
            </section>

            <!-- Industry Performance Correlation (Real Data) -->
            <section class="chart-section">
                <h2>üìä Industry Performance Correlation</h2>
                <p class="chart-description">Correlation between industry type and performance scores - bubble size represents number of websites</p>
                <div class="chart-container">
                    <canvas id="industryCorrelationChart"></canvas>
                </div>
            </section>

            <!-- Regional Performance Analysis (Real Data) -->
            <section class="chart-section">
                <h2>üåç Regional Performance Analysis</h2>
                <p class="chart-description">Performance distribution by major regions</p>
                <div class="chart-container">
                    <canvas id="regionalAnalysisChart"></canvas>
                </div>
            </section>

        </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            
            <div class="footer-section">
                <p><button onclick="openWebsiteModal()" class="suggest-btn">Test your site</button></p>
                <p><a href="stats.html">Stats</a> |¬†<a href="about.html">About</a> | <a href="api-docs.html">API Documentation</a> |¬†<a href="latest-updated.html">Latest Scan</a> |¬†<a href="queued-sites.html">Queued Sites</a> |¬†<a href="https://flipsite.io" target="_blank">Build 100% scoring sites</a></p>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>&copy; 2025 CheetahCheck. Google Lighthouse performance monitoring of 1016 websites.</p>
        </div>
    </footer>

        <!-- Website Suggestion Modal -->
        <div id="websiteModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Test Your Website</h2>
                    <button class="close-btn" onclick="closeWebsiteModal()" aria-label="Close test form">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="websiteForm" onsubmit="handleWebsiteSubmission(event)">
                        <div class="form-group">
                            <label for="websiteUrl">Website URL *</label>
                            <input type="url" id="websiteUrl" name="url" required 
                                   placeholder="https://example.com" 
                                   aria-describedby="url-help">
                            <small id="url-help">Enter the full URL including https://</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="userEmail">Email Address *</label>
                            <input type="email" id="userEmail" name="email" required 
                                   placeholder="your@email.com" 
                                   aria-describedby="email-help">
                        </div>
                        
                        <div class="form-group">
                            <label for="websiteCategory">Category</label>
                            <select id="websiteCategory" name="category">
                                <option value="">Select a category (optional)</option>
                                <option value="e-commerce">E-commerce</option>
                                <option value="news-media">News & Media</option>
                                <option value="technology">Technology</option>
                                <option value="education">Education</option>
                                <option value="government">Government</option>
                                <option value="healthcare">Healthcare</option>
                                <option value="finance">Finance</option>
                                <option value="entertainment">Entertainment</option>
                                <option value="travel">Travel</option>
                                <option value="food-beverage">Food & Beverage</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="websiteDescription">Additional Notes (Optional)</label>
                            <textarea id="websiteDescription" name="description" rows="3" 
                                      placeholder="Any feedback or ideas..." 
                                      maxlength="500"></textarea>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" onclick="closeWebsiteModal()" class="btn-secondary">Cancel</button>
                            <button type="submit" class="btn-primary">Submit for Testing</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <script>
        function openWebsiteModal() {
            const modal = document.getElementById('websiteModal');
            modal.style.display = 'block';
            modal.setAttribute('aria-hidden', 'false');
            
            // Focus the first input for accessibility
            setTimeout(() => {
                document.getElementById('websiteUrl').focus();
            }, 100);
            
            // Trap focus within modal
            modal.addEventListener('keydown', trapFocus);
        }

        function closeWebsiteModal() {
            const modal = document.getElementById('websiteModal');
            modal.style.display = 'none';
            modal.setAttribute('aria-hidden', 'true');
            modal.removeEventListener('keydown', trapFocus);
            
            // Reset form
            document.getElementById('websiteForm').reset();
        }

        function trapFocus(e) {
            if (e.key === 'Escape') {
                closeWebsiteModal();
                return;
            }
            
            if (e.key === 'Tab') {
                const modal = document.getElementById('websiteModal');
                const focusableElements = modal.querySelectorAll(
                    'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
                );
                const firstElement = focusableElements[0];
                const lastElement = focusableElements[focusableElements.length - 1];

                if (e.shiftKey) {
                    if (document.activeElement === firstElement) {
                        lastElement.focus();
                        e.preventDefault();
                    }
                } else {
                    if (document.activeElement === lastElement) {
                        firstElement.focus();
                        e.preventDefault();
                    }
                }
            }
        }

        function handleWebsiteSubmission(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const data = {
                url: formData.get('url'),
                category: formData.get('category'),
                description: formData.get('description'),
                timestamp: new Date().toISOString()
            };
            
            // Here you could send to your backend/API
            console.log('Website suggestion submitted:', data);
            
            // Show success message
            alert('Thank you for your suggestion! We\'ll review it and consider adding it to our lighthouse monitoring.');
            
            // Close modal
            closeWebsiteModal();
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('websiteModal');
            if (event.target === modal) {
                closeWebsiteModal();
            }
        }
        </script>
    </div>

    <script>
        // ALL CHARTS USE ONLY REAL DATA FROM THE DATABASE

        // Top Industries Chart (Real Data)
        const topIndustriesCtx = document.getElementById('topIndustriesChart');
        if (topIndustriesCtx) {
            new Chart(topIndustriesCtx, {
                type: 'bar',
                data: {
                    labels: ['Website editor', 'Gaming', 'Defense', 'Conglomerate', 'Government', 'Jobs', 'Publishing', 'Tech', 'Cybersecurity', 'Consulting'],
                    datasets: [{
                        label: 'Average Performance Score',
                        data: [67, 66, 64, 62, 61.1, 58.8, 58, 57, 57, 56.7],
                        backgroundColor: [
                            '#22C55E', '#16A34A', '#15803D', '#FFB703', '#E07A00', '#D97706',
                            '#EF4444', '#DC2626', '#B91C1C', '#991B1B'
                        ],
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: {
                        legend: { display: false },
                        title: {
                            display: true,
                            text: 'Real Performance Data by Industry'
                        }
                    },
                    scales: {
                        x: { beginAtZero: true, max: 100 }
                    }
                }
            });
        }

        // Top Countries Chart (Real Data)
        const topCountriesCtx = document.getElementById('topCountriesChart');
        if (topCountriesCtx) {
            new Chart(topCountriesCtx, {
                type: 'bar',
                data: {
                    labels: ['üá≤üáæ Malaysia', 'üáßüá¥ Bolivia', 'üáÆüá∑ Iran', 'üá®üá∫ Cuba', 'üá≤üáΩ Mexico', 'üá∫üáæ Uruguay', 'üá∫üá¶ Ukraine', 'üáøüá≤ Zambia', 'üá±üáæ Libya', 'üá≤üáπ Malta'],
                    datasets: [{
                        label: 'Average Performance Score',
                        data: [83, 67.8, 65.2, 64.3, 58.8, 56.5, 55.5, 55, 53.2, 52.5],
                        backgroundColor: '#22C55E',
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        title: {
                            display: true,
                            text: 'Top 10 Countries by Performance Score'
                        }
                    },
                    scales: {
                        y: { beginAtZero: true, max: 100 }
                    }
                }
            });
        }

        // Industry Benchmarking (Real Data - Top 5 by Domain Count)
        const industryBenchmarkCtx = document.getElementById('industryBenchmarkChart');
        if (industryBenchmarkCtx) {
            // Sort industries by site count and get top 5
            const industriesBySiteCount = [{
                industry: 'Website editor',
                site_count: 5,
                performance: 67,
                accessibility: 93.6,
                best_practices: 86.6,
                seo: 92.4,
                pwa: 39.8
            }, {
                industry: 'Gaming',
                site_count: 7,
                performance: 66,
                accessibility: 94,
                best_practices: 93,
                seo: 94.7,
                pwa: 36.3
            }, {
                industry: 'Defense',
                site_count: 2,
                performance: 64,
                accessibility: 90,
                best_practices: 87.5,
                seo: 81.5,
                pwa: 38.5
            }, {
                industry: 'Conglomerate',
                site_count: 1,
                performance: 62,
                accessibility: 95,
                best_practices: 100,
                seo: 98,
                pwa: 33
            }, {
                industry: 'Government',
                site_count: 41,
                performance: 61.1,
                accessibility: 89.4,
                best_practices: 88.9,
                seo: 91.3,
                pwa: 35.8
            }, {
                industry: 'Jobs',
                site_count: 8,
                performance: 58.8,
                accessibility: 85.9,
                best_practices: 77.1,
                seo: 90.4,
                pwa: 48.5
            }, {
                industry: 'Publishing',
                site_count: 1,
                performance: 58,
                accessibility: 88,
                best_practices: 92,
                seo: 80,
                pwa: 33
            }, {
                industry: 'Tech',
                site_count: 1,
                performance: 57,
                accessibility: 89,
                best_practices: 83,
                seo: 93,
                pwa: 33
            }, {
                industry: 'Cybersecurity',
                site_count: 2,
                performance: 57,
                accessibility: 84.5,
                best_practices: 91.5,
                seo: 93,
                pwa: 33
            }, {
                industry: 'Consulting',
                site_count: 10,
                performance: 56.7,
                accessibility: 96.2,
                best_practices: 90.8,
                seo: 90.3,
                pwa: 38.6
            }, {
                industry: 'Pharmaceutical',
                site_count: 1,
                performance: 55,
                accessibility: 93,
                best_practices: 75,
                seo: 100,
                pwa: 33
            }, {
                industry: 'Business',
                site_count: 1,
                performance: 55,
                accessibility: 84,
                best_practices: 92,
                seo: 100,
                pwa: 67
            }, {
                industry: 'Engineering',
                site_count: 3,
                performance: 53.7,
                accessibility: 86.3,
                best_practices: 89,
                seo: 90.3,
                pwa: 33
            }, {
                industry: 'Healthtech',
                site_count: 6,
                performance: 52.7,
                accessibility: 88.2,
                best_practices: 91.7,
                seo: 94.8,
                pwa: 48
            }, {
                industry: 'Edtech',
                site_count: 19,
                performance: 51.7,
                accessibility: 85.7,
                best_practices: 84.2,
                seo: 88.9,
                pwa: 43.6
            }, {
                industry: 'Social',
                site_count: 9,
                performance: 51.3,
                accessibility: 86.2,
                best_practices: 79.7,
                seo: 93.4,
                pwa: 61.8
            }, {
                industry: 'Search Engine',
                site_count: 5,
                performance: 51,
                accessibility: 83.6,
                best_practices: 84.8,
                seo: 83.4,
                pwa: 33
            }, {
                industry: 'Industry',
                site_count: 4,
                performance: 51,
                accessibility: 92.5,
                best_practices: 89.5,
                seo: 89.8,
                pwa: 41.5
            }, {
                industry: 'Healthcare',
                site_count: 13,
                performance: 49.8,
                accessibility: 92.1,
                best_practices: 88.5,
                seo: 91.6,
                pwa: 44.3
            }, {
                industry: 'Education',
                site_count: 48,
                performance: 49.1,
                accessibility: 88.7,
                best_practices: 88.6,
                seo: 88.4,
                pwa: 36.3
            }, {
                industry: 'Research',
                site_count: 3,
                performance: 49,
                accessibility: 94.7,
                best_practices: 97.3,
                seo: 94.7,
                pwa: 40.7
            }, {
                industry: 'Food',
                site_count: 3,
                performance: 48.7,
                accessibility: 90.7,
                best_practices: 97.3,
                seo: 88.3,
                pwa: 55.7
            }, {
                industry: 'CRM',
                site_count: 3,
                performance: 48.7,
                accessibility: 84,
                best_practices: 92,
                seo: 90,
                pwa: 33
            }, {
                industry: 'Finance',
                site_count: 125,
                performance: 46.8,
                accessibility: 87.9,
                best_practices: 82.1,
                seo: 89.1,
                pwa: 36.7
            }, {
                industry: 'Manufacturing',
                site_count: 3,
                performance: 46,
                accessibility: 94.3,
                best_practices: 80.3,
                seo: 90,
                pwa: 33
            }, {
                industry: 'Portal',
                site_count: 30,
                performance: 45.9,
                accessibility: 77.5,
                best_practices: 74.2,
                seo: 89.2,
                pwa: 46.1
            }, {
                industry: 'E-commerce',
                site_count: 69,
                performance: 45,
                accessibility: 81.8,
                best_practices: 78.5,
                seo: 89.2,
                pwa: 45.9
            }, {
                industry: 'Energy',
                site_count: 9,
                performance: 44.7,
                accessibility: 88.7,
                best_practices: 88.8,
                seo: 85.8,
                pwa: 38
            }, {
                industry: 'Travel',
                site_count: 7,
                performance: 43.6,
                accessibility: 81,
                best_practices: 78.6,
                seo: 86.4,
                pwa: 60.3
            }, {
                industry: 'Software',
                site_count: 10,
                performance: 42.7,
                accessibility: 89.8,
                best_practices: 82.5,
                seo: 91.6,
                pwa: 43.1
            }, {
                industry: 'Social Media',
                site_count: 15,
                performance: 42.5,
                accessibility: 79.5,
                best_practices: 67.3,
                seo: 89.2,
                pwa: 49.5
            }, {
                industry: 'Media',
                site_count: 359,
                performance: 42.4,
                accessibility: 85.1,
                best_practices: 78.9,
                seo: 90.5,
                pwa: 44.2
            }, {
                industry: 'Sports',
                site_count: 8,
                performance: 41.3,
                accessibility: 77,
                best_practices: 80.3,
                seo: 83.9,
                pwa: 40.1
            }, {
                industry: 'Marketing',
                site_count: 9,
                performance: 41.2,
                accessibility: 91.1,
                best_practices: 68.4,
                seo: 92.1,
                pwa: 30.6
            }, {
                industry: 'Construction',
                site_count: 2,
                performance: 41,
                accessibility: 83.5,
                best_practices: 92,
                seo: 83.5,
                pwa: 33
            }, {
                industry: 'Marketplace',
                site_count: 26,
                performance: 40.9,
                accessibility: 86,
                best_practices: 83.5,
                seo: 91.1,
                pwa: 49.1
            }, {
                industry: 'Technology',
                site_count: 31,
                performance: 40.4,
                accessibility: 87.9,
                best_practices: 79.8,
                seo: 85.9,
                pwa: 35.9
            }, {
                industry: 'Career',
                site_count: 1,
                performance: 39,
                accessibility: 83,
                best_practices: 75,
                seo: 98,
                pwa: 100
            }, {
                industry: 'Non-profit',
                site_count: 2,
                performance: 38.5,
                accessibility: 84.5,
                best_practices: 83,
                seo: 85.5,
                pwa: 33
            }, {
                industry: 'Transportation',
                site_count: 26,
                performance: 38.4,
                accessibility: 88.2,
                best_practices: 77.5,
                seo: 89.7,
                pwa: 41.2
            }, {
                industry: 'Video',
                site_count: 1,
                performance: 38,
                accessibility: 91,
                best_practices: 75,
                seo: 93,
                pwa: 33
            }, {
                industry: 'Realestate',
                site_count: 5,
                performance: 37.8,
                accessibility: 90.4,
                best_practices: 81.6,
                seo: 92.6,
                pwa: 33
            }, {
                industry: 'Automotive',
                site_count: 15,
                performance: 37.3,
                accessibility: 89.5,
                best_practices: 75.5,
                seo: 90.9,
                pwa: 44.3
            }, {
                industry: 'Telecom',
                site_count: 42,
                performance: 34.5,
                accessibility: 85.5,
                best_practices: 80.1,
                seo: 88.6,
                pwa: 37.6
            }, {
                industry: 'Food & Drink',
                site_count: 1,
                performance: 34,
                accessibility: 88,
                best_practices: 75,
                seo: 82,
                pwa: 33
            }, {
                industry: 'Retail',
                site_count: 12,
                performance: 33.8,
                accessibility: 86.4,
                best_practices: 70.3,
                seo: 86.7,
                pwa: 41.5
            }, {
                industry: 'Hospitality',
                site_count: 1,
                performance: 32,
                accessibility: 100,
                best_practices: 83,
                seo: 100,
                pwa: 56
            }, {
                industry: 'Real Estate',
                site_count: 2,
                performance: 30.5,
                accessibility: 88.5,
                best_practices: 79,
                seo: 89,
                pwa: 89
            }, {
                industry: 'Weather',
                site_count: 2,
                performance: 29,
                accessibility: 96,
                best_practices: 83,
                seo: 95,
                pwa: 50
            }, {
                industry: 'Delivery',
                site_count: 7,
                performance: 28.6,
                accessibility: 88.4,
                best_practices: 69.1,
                seo: 91.4,
                pwa: 44.3
            }].sort((a, b) => b.site_count - a.site_count).slice(0, 5);
            
            const datasets = industriesBySiteCount.map((ind, index) => ({
                label: ind.industry + ' (' + ind.site_count + ' sites)',
                data: [ind.performance, ind.accessibility, ind.best_practices, ind.seo, ind.pwa],
                borderColor: ['#22C55E', '#3B82F6', '#8B5CF6', '#FFB703', '#EF4444'][index],
                backgroundColor: ['rgba(34, 197, 94, 0.2)', 'rgba(59, 130, 246, 0.2)', 'rgba(139, 92, 246, 0.2)', 'rgba(255, 183, 3, 0.2)', 'rgba(239, 68, 68, 0.2)'][index],
                pointBackgroundColor: ['#22C55E', '#3B82F6', '#8B5CF6', '#FFB703', '#EF4444'][index]
            }));
            
            // Add global average
            datasets.push({
                label: 'Global Average',
                data: [44.7, 86.2, 80.7, 89.8, 42.1],
                borderColor: '#6B7280',
                backgroundColor: 'rgba(107, 114, 128, 0.1)',
                pointBackgroundColor: '#6B7280',
                borderDash: [5, 5]
            });

            new Chart(industryBenchmarkCtx, {
                type: 'radar',
                data: {
                    labels: ['Performance', 'Accessibility', 'Best Practices', 'SEO', 'PWA'],
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Top 5 Industries by Domain Count'
                        }
                    },
                    scales: {
                        r: {
                            suggestedMin: 0,
                            suggestedMax: 100
                        }
                    }
                }
            });
        }

        // Industry Performance Correlation (Real Data - Bubble Chart)
        const industryCorrelationCtx = document.getElementById('industryCorrelationChart');
        if (industryCorrelationCtx) {
            // Create bubble chart data showing correlation between industry and performance
            const industryData = [{
                label: 'Website editor',
                x: 1, // Industry index (categorical x-axis)
                y: 67, // Performance score
                r: 15, // Bubble size based on number of sites
                backgroundColor: '#22C55E80'
            }, {
                label: 'Gaming',
                x: 2, // Industry index (categorical x-axis)
                y: 66, // Performance score
                r: 21, // Bubble size based on number of sites
                backgroundColor: '#16A34A80'
            }, {
                label: 'Defense',
                x: 3, // Industry index (categorical x-axis)
                y: 64, // Performance score
                r: 6, // Bubble size based on number of sites
                backgroundColor: '#15803D80'
            }, {
                label: 'Conglomerate',
                x: 4, // Industry index (categorical x-axis)
                y: 62, // Performance score
                r: 5, // Bubble size based on number of sites
                backgroundColor: '#FFB70380'
            }, {
                label: 'Government',
                x: 5, // Industry index (categorical x-axis)
                y: 61.1, // Performance score
                r: 25, // Bubble size based on number of sites
                backgroundColor: '#E07A0080'
            }, {
                label: 'Jobs',
                x: 6, // Industry index (categorical x-axis)
                y: 58.8, // Performance score
                r: 24, // Bubble size based on number of sites
                backgroundColor: '#D9770680'
            }, {
                label: 'Publishing',
                x: 7, // Industry index (categorical x-axis)
                y: 58, // Performance score
                r: 5, // Bubble size based on number of sites
                backgroundColor: '#EF444480'
            }, {
                label: 'Tech',
                x: 8, // Industry index (categorical x-axis)
                y: 57, // Performance score
                r: 5, // Bubble size based on number of sites
                backgroundColor: '#DC262680'
            }, {
                label: 'Cybersecurity',
                x: 9, // Industry index (categorical x-axis)
                y: 57, // Performance score
                r: 6, // Bubble size based on number of sites
                backgroundColor: '#B91C1C80'
            }, {
                label: 'Consulting',
                x: 10, // Industry index (categorical x-axis)
                y: 56.7, // Performance score
                r: 25, // Bubble size based on number of sites
                backgroundColor: '#991B1B80'
            }, {
                label: 'Pharmaceutical',
                x: 11, // Industry index (categorical x-axis)
                y: 55, // Performance score
                r: 5, // Bubble size based on number of sites
                backgroundColor: '#8B5CF680'
            }, {
                label: 'Business',
                x: 12, // Industry index (categorical x-axis)
                y: 55, // Performance score
                r: 5, // Bubble size based on number of sites
                backgroundColor: '#7C3AED80'
            }, {
                label: 'Engineering',
                x: 13, // Industry index (categorical x-axis)
                y: 53.7, // Performance score
                r: 9, // Bubble size based on number of sites
                backgroundColor: '#6366F180'
            }, {
                label: 'Healthtech',
                x: 14, // Industry index (categorical x-axis)
                y: 52.7, // Performance score
                r: 18, // Bubble size based on number of sites
                backgroundColor: '#4F46E580'
            }, {
                label: 'Edtech',
                x: 15, // Industry index (categorical x-axis)
                y: 51.7, // Performance score
                r: 25, // Bubble size based on number of sites
                backgroundColor: '#3B82F680'
            }, {
                label: 'Social',
                x: 16, // Industry index (categorical x-axis)
                y: 51.3, // Performance score
                r: 25, // Bubble size based on number of sites
                backgroundColor: '#2563EB80'
            }, {
                label: 'Search Engine',
                x: 17, // Industry index (categorical x-axis)
                y: 51, // Performance score
                r: 15, // Bubble size based on number of sites
                backgroundColor: '#1D4ED880'
            }, {
                label: 'Industry',
                x: 18, // Industry index (categorical x-axis)
                y: 51, // Performance score
                r: 12, // Bubble size based on number of sites
                backgroundColor: '#1E40AF80'
            }, {
                label: 'Healthcare',
                x: 19, // Industry index (categorical x-axis)
                y: 49.8, // Performance score
                r: 25, // Bubble size based on number of sites
                backgroundColor: '#1E3A8A80'
            }, {
                label: 'Education',
                x: 20, // Industry index (categorical x-axis)
                y: 49.1, // Performance score
                r: 25, // Bubble size based on number of sites
                backgroundColor: '#312E8180'
            }, {
                label: 'Research',
                x: 21, // Industry index (categorical x-axis)
                y: 49, // Performance score
                r: 9, // Bubble size based on number of sites
                backgroundColor: '#10B98180'
            }, {
                label: 'Food',
                x: 22, // Industry index (categorical x-axis)
                y: 48.7, // Performance score
                r: 9, // Bubble size based on number of sites
                backgroundColor: '#05966980'
            }, {
                label: 'CRM',
                x: 23, // Industry index (categorical x-axis)
                y: 48.7, // Performance score
                r: 9, // Bubble size based on number of sites
                backgroundColor: '#04785780'
            }, {
                label: 'Finance',
                x: 24, // Industry index (categorical x-axis)
                y: 46.8, // Performance score
                r: 25, // Bubble size based on number of sites
                backgroundColor: '#065F4680'
            }, {
                label: 'Manufacturing',
                x: 25, // Industry index (categorical x-axis)
                y: 46, // Performance score
                r: 9, // Bubble size based on number of sites
                backgroundColor: '#064E3B80'
            }, {
                label: 'Portal',
                x: 26, // Industry index (categorical x-axis)
                y: 45.9, // Performance score
                r: 25, // Bubble size based on number of sites
                backgroundColor: '#F59E0B80'
            }, {
                label: 'E-commerce',
                x: 27, // Industry index (categorical x-axis)
                y: 45, // Performance score
                r: 25, // Bubble size based on number of sites
                backgroundColor: '#D9770680'
            }, {
                label: 'Energy',
                x: 28, // Industry index (categorical x-axis)
                y: 44.7, // Performance score
                r: 25, // Bubble size based on number of sites
                backgroundColor: '#B4530980'
            }, {
                label: 'Travel',
                x: 29, // Industry index (categorical x-axis)
                y: 43.6, // Performance score
                r: 21, // Bubble size based on number of sites
                backgroundColor: '#92400E80'
            }, {
                label: 'Software',
                x: 30, // Industry index (categorical x-axis)
                y: 42.7, // Performance score
                r: 25, // Bubble size based on number of sites
                backgroundColor: '#78350F80'
            }, {
                label: 'Social Media',
                x: 31, // Industry index (categorical x-axis)
                y: 42.5, // Performance score
                r: 25, // Bubble size based on number of sites
                backgroundColor: '#EF444480'
            }, {
                label: 'Media',
                x: 32, // Industry index (categorical x-axis)
                y: 42.4, // Performance score
                r: 25, // Bubble size based on number of sites
                backgroundColor: '#DC262680'
            }, {
                label: 'Sports',
                x: 33, // Industry index (categorical x-axis)
                y: 41.3, // Performance score
                r: 24, // Bubble size based on number of sites
                backgroundColor: '#B91C1C80'
            }, {
                label: 'Marketing',
                x: 34, // Industry index (categorical x-axis)
                y: 41.2, // Performance score
                r: 25, // Bubble size based on number of sites
                backgroundColor: '#991B1B80'
            }, {
                label: 'Construction',
                x: 35, // Industry index (categorical x-axis)
                y: 41, // Performance score
                r: 6, // Bubble size based on number of sites
                backgroundColor: '#7F1D1D80'
            }, {
                label: 'Marketplace',
                x: 36, // Industry index (categorical x-axis)
                y: 40.9, // Performance score
                r: 25, // Bubble size based on number of sites
                backgroundColor: '#6B728080'
            }, {
                label: 'Technology',
                x: 37, // Industry index (categorical x-axis)
                y: 40.4, // Performance score
                r: 25, // Bubble size based on number of sites
                backgroundColor: '#22C55E80'
            }, {
                label: 'Career',
                x: 38, // Industry index (categorical x-axis)
                y: 39, // Performance score
                r: 5, // Bubble size based on number of sites
                backgroundColor: '#16A34A80'
            }, {
                label: 'Non-profit',
                x: 39, // Industry index (categorical x-axis)
                y: 38.5, // Performance score
                r: 6, // Bubble size based on number of sites
                backgroundColor: '#15803D80'
            }, {
                label: 'Transportation',
                x: 40, // Industry index (categorical x-axis)
                y: 38.4, // Performance score
                r: 25, // Bubble size based on number of sites
                backgroundColor: '#FFB70380'
            }, {
                label: 'Video',
                x: 41, // Industry index (categorical x-axis)
                y: 38, // Performance score
                r: 5, // Bubble size based on number of sites
                backgroundColor: '#E07A0080'
            }, {
                label: 'Realestate',
                x: 42, // Industry index (categorical x-axis)
                y: 37.8, // Performance score
                r: 15, // Bubble size based on number of sites
                backgroundColor: '#D9770680'
            }, {
                label: 'Automotive',
                x: 43, // Industry index (categorical x-axis)
                y: 37.3, // Performance score
                r: 25, // Bubble size based on number of sites
                backgroundColor: '#EF444480'
            }, {
                label: 'Telecom',
                x: 44, // Industry index (categorical x-axis)
                y: 34.5, // Performance score
                r: 25, // Bubble size based on number of sites
                backgroundColor: '#DC262680'
            }, {
                label: 'Food & Drink',
                x: 45, // Industry index (categorical x-axis)
                y: 34, // Performance score
                r: 5, // Bubble size based on number of sites
                backgroundColor: '#B91C1C80'
            }, {
                label: 'Retail',
                x: 46, // Industry index (categorical x-axis)
                y: 33.8, // Performance score
                r: 25, // Bubble size based on number of sites
                backgroundColor: '#991B1B80'
            }, {
                label: 'Hospitality',
                x: 47, // Industry index (categorical x-axis)
                y: 32, // Performance score
                r: 5, // Bubble size based on number of sites
                backgroundColor: '#8B5CF680'
            }, {
                label: 'Real Estate',
                x: 48, // Industry index (categorical x-axis)
                y: 30.5, // Performance score
                r: 6, // Bubble size based on number of sites
                backgroundColor: '#7C3AED80'
            }, {
                label: 'Weather',
                x: 49, // Industry index (categorical x-axis)
                y: 29, // Performance score
                r: 6, // Bubble size based on number of sites
                backgroundColor: '#6366F180'
            }, {
                label: 'Delivery',
                x: 50, // Industry index (categorical x-axis)
                y: 28.6, // Performance score
                r: 21, // Bubble size based on number of sites
                backgroundColor: '#4F46E580'
            }];

            new Chart(industryCorrelationCtx, {
                type: 'bubble',
                data: {
                    datasets: [{
                        label: 'Industries',
                        data: industryData,
                        borderColor: '#22C55E',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Industry Performance Correlation (Bubble size = # of websites)'
                        },
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                title: function(context) {
                                    return context[0].raw.label;
                                },
                                label: function(context) {
                                    const data = context.raw;
                                    const siteCount = Math.round(data.r / 3);
                                    return [
                                        `Performance: ${data.y}`,
                                        `Websites: ${siteCount}`,
                                        `Industry rank: #${data.x}`
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom',
                            title: {
                                display: true,
                                text: 'Industry Rank (by Performance)'
                            },
                            min: 0,
                            max: 51,
                            ticks: {
                                stepSize: 1,
                                callback: function(value) {
                                    if (value === 0 || value > 50) return '';
                                    const industries = ['Website editor', 'Gaming', 'Defense', 'Conglomerate', 'Government', 'Jobs', 'Publishing', 'Tech', 'Cybersecurity', 'Consulting', 'Pharmaceutical', 'Business', 'Engineering', 'Healthtech', 'Edtech', 'Social', 'Search Engine', 'Industry', 'Healthcare', 'Education', 'Research', 'Food', 'CRM', 'Finance', 'Manufacturing', 'Portal', 'E-commerce', 'Energy', 'Travel', 'Software', 'Social Media', 'Media', 'Sports', 'Marketing', 'Construction', 'Marketplace', 'Technology', 'Career', 'Non-profit', 'Transportation', 'Video', 'Realestate', 'Automotive', 'Telecom', 'Food & Drink', 'Retail', 'Hospitality', 'Real Estate', 'Weather', 'Delivery'];
                                    return industries[value - 1] ? industries[value - 1].substring(0, 8) + '...' : '';
                                }
                            }
                        },
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: true,
                                text: 'Average Performance Score'
                            }
                        }
                    }
                }
            });
        }

        // Regional Performance Analysis (Real Data - Interactive Horizontal Bar Chart)
        const regionalAnalysisCtx = document.getElementById('regionalAnalysisChart');
        if (regionalAnalysisCtx) {
            // Store country data for each region for interactive functionality
            const regionCountryData = {
                'Europe': [{"country":"Ukraine","site_count":10,"avg_performance":55.5,"avg_accessibility":79.5,"avg_best_practices":75.9,"avg_seo":92.3,"avg_pwa":54.4,"best_performance":87,"worst_performance":38},{"country":"Malta","site_count":4,"avg_performance":52.5,"avg_accessibility":85.5,"avg_best_practices":50,"avg_seo":84.3,"avg_pwa":30.5,"best_performance":66,"worst_performance":37},{"country":"Belgium","site_count":8,"avg_performance":51.4,"avg_accessibility":92.9,"avg_best_practices":82.5,"avg_seo":90.3,"avg_pwa":38.8,"best_performance":74,"worst_performance":31},{"country":"Netherlands","site_count":10,"avg_performance":51.1,"avg_accessibility":94.3,"avg_best_practices":82.6,"avg_seo":90.8,"avg_pwa":35.3,"best_performance":90,"worst_performance":16},{"country":"France","site_count":9,"avg_performance":50.7,"avg_accessibility":86.9,"avg_best_practices":88,"avg_seo":94.9,"avg_pwa":65.4,"best_performance":76,"worst_performance":33},{"country":"Sweden","site_count":99,"avg_performance":50.5,"avg_accessibility":92.2,"avg_best_practices":90.9,"avg_seo":93.1,"avg_pwa":40.6,"best_performance":98,"worst_performance":18},{"country":"Lithuania","site_count":5,"avg_performance":48.6,"avg_accessibility":66.6,"avg_best_practices":78.2,"avg_seo":87.6,"avg_pwa":48.8,"best_performance":89,"worst_performance":14},{"country":"Finland","site_count":130,"avg_performance":48.6,"avg_accessibility":90.6,"avg_best_practices":87.9,"avg_seo":92.2,"avg_pwa":39.9,"best_performance":97,"worst_performance":8},{"country":"Greece","site_count":5,"avg_performance":48,"avg_accessibility":86,"avg_best_practices":78.4,"avg_seo":93,"avg_pwa":33,"best_performance":64,"worst_performance":27},{"country":"Norway","site_count":9,"avg_performance":46.6,"avg_accessibility":92.8,"avg_best_practices":88.8,"avg_seo":94.2,"avg_pwa":36.8,"best_performance":59,"worst_performance":30},{"country":"Turkey","site_count":7,"avg_performance":46.1,"avg_accessibility":88.4,"avg_best_practices":83.4,"avg_seo":90.9,"avg_pwa":42.6,"best_performance":82,"worst_performance":26},{"country":"Denmark","site_count":9,"avg_performance":45.9,"avg_accessibility":89.9,"avg_best_practices":91.7,"avg_seo":93.2,"avg_pwa":41.8,"best_performance":86,"worst_performance":25},{"country":"Austria","site_count":10,"avg_performance":45.8,"avg_accessibility":88.7,"avg_best_practices":87.6,"avg_seo":90,"avg_pwa":46.6,"best_performance":63,"worst_performance":28},{"country":"Poland","site_count":24,"avg_performance":45.3,"avg_accessibility":85.5,"avg_best_practices":80.9,"avg_seo":92.3,"avg_pwa":53.2,"best_performance":71,"worst_performance":5},{"country":"Luxembourg","site_count":6,"avg_performance":43.7,"avg_accessibility":92.2,"avg_best_practices":84.8,"avg_seo":92.5,"avg_pwa":44.3,"best_performance":78,"worst_performance":22},{"country":"Germany","site_count":38,"avg_performance":43.6,"avg_accessibility":89.8,"avg_best_practices":89.4,"avg_seo":92,"avg_pwa":47.8,"best_performance":90,"worst_performance":5},{"country":"Italy","site_count":9,"avg_performance":43.1,"avg_accessibility":84,"avg_best_practices":80.4,"avg_seo":87.4,"avg_pwa":40.6,"best_performance":70,"worst_performance":25},{"country":"Russia","site_count":9,"avg_performance":42.8,"avg_accessibility":74.7,"avg_best_practices":63.8,"avg_seo":91.9,"avg_pwa":59.3,"best_performance":78,"worst_performance":9},{"country":"United Kingdom","site_count":33,"avg_performance":42.5,"avg_accessibility":88.5,"avg_best_practices":80,"avg_seo":89.2,"avg_pwa":43.5,"best_performance":94,"worst_performance":0},{"country":"Spain","site_count":9,"avg_performance":41.7,"avg_accessibility":86.3,"avg_best_practices":78.7,"avg_seo":89.2,"avg_pwa":48,"best_performance":63,"worst_performance":12},{"country":"Portugal","site_count":7,"avg_performance":40.7,"avg_accessibility":88.4,"avg_best_practices":78.4,"avg_seo":92.3,"avg_pwa":33,"best_performance":89,"worst_performance":20},{"country":"Romania","site_count":8,"avg_performance":39.6,"avg_accessibility":90.8,"avg_best_practices":70.8,"avg_seo":92,"avg_pwa":37.3,"best_performance":71,"worst_performance":20},{"country":"Slovakia","site_count":8,"avg_performance":39.3,"avg_accessibility":84.9,"avg_best_practices":81,"avg_seo":90.8,"avg_pwa":45.6,"best_performance":51,"worst_performance":34},{"country":"Latvia","site_count":6,"avg_performance":37.8,"avg_accessibility":77,"avg_best_practices":80.5,"avg_seo":85.2,"avg_pwa":44.3,"best_performance":100,"worst_performance":15},{"country":"Estonia","site_count":10,"avg_performance":36.3,"avg_accessibility":84.7,"avg_best_practices":85.9,"avg_seo":89.4,"avg_pwa":43.1,"best_performance":85,"worst_performance":3},{"country":"Switzerland","site_count":8,"avg_performance":35.6,"avg_accessibility":93,"avg_best_practices":83.1,"avg_seo":93.4,"avg_pwa":42.9,"best_performance":54,"worst_performance":28},{"country":"Bulgaria","site_count":9,"avg_performance":30.1,"avg_accessibility":87.2,"avg_best_practices":70.4,"avg_seo":92.4,"avg_pwa":40.6,"best_performance":48,"worst_performance":0},{"country":"Hungary","site_count":8,"avg_performance":29.1,"avg_accessibility":77.4,"avg_best_practices":75.9,"avg_seo":90.6,"avg_pwa":45.6,"best_performance":68,"worst_performance":16}],
                'Asia': [{"country":"Malaysia","site_count":3,"avg_performance":83,"avg_accessibility":83.3,"avg_best_practices":92,"avg_seo":85.7,"avg_pwa":33,"best_performance":84,"worst_performance":81},{"country":"Pakistan","site_count":9,"avg_performance":48.6,"avg_accessibility":73.9,"avg_best_practices":78.7,"avg_seo":89.6,"avg_pwa":41.8,"best_performance":85,"worst_performance":24},{"country":"India","site_count":107,"avg_performance":47.2,"avg_accessibility":81.6,"avg_best_practices":75.6,"avg_seo":84.9,"avg_pwa":48.4,"best_performance":100,"worst_performance":5},{"country":"Japan","site_count":7,"avg_performance":42.4,"avg_accessibility":81,"avg_best_practices":86.9,"avg_seo":89,"avg_pwa":33,"best_performance":66,"worst_performance":11},{"country":"China","site_count":9,"avg_performance":41.9,"avg_accessibility":54.2,"avg_best_practices":68.7,"avg_seo":85.4,"avg_pwa":41.8,"best_performance":66,"worst_performance":22},{"country":"Bangladesh","site_count":5,"avg_performance":39.4,"avg_accessibility":79.8,"avg_best_practices":70.2,"avg_seo":92.4,"avg_pwa":57.6,"best_performance":77,"worst_performance":10},{"country":"Taiwan","site_count":2,"avg_performance":37.5,"avg_accessibility":83.5,"avg_best_practices":83.5,"avg_seo":100,"avg_pwa":33,"best_performance":59,"worst_performance":16},{"country":"South Korea","site_count":10,"avg_performance":37.2,"avg_accessibility":76.8,"avg_best_practices":74.9,"avg_seo":88.8,"avg_pwa":33,"best_performance":53,"worst_performance":24},{"country":"Thailand","site_count":7,"avg_performance":35.1,"avg_accessibility":91.1,"avg_best_practices":75,"avg_seo":94.1,"avg_pwa":52.3,"best_performance":90,"worst_performance":10},{"country":"Vietnam","site_count":7,"avg_performance":32.6,"avg_accessibility":83.1,"avg_best_practices":75,"avg_seo":91.4,"avg_pwa":34.6,"best_performance":49,"worst_performance":27},{"country":"Philippines","site_count":7,"avg_performance":32.4,"avg_accessibility":70.9,"avg_best_practices":63,"avg_seo":78.3,"avg_pwa":42.6,"best_performance":65,"worst_performance":16},{"country":"Hong Kong","site_count":5,"avg_performance":31.6,"avg_accessibility":74,"avg_best_practices":80,"avg_seo":82.6,"avg_pwa":33,"best_performance":60,"worst_performance":9},{"country":"Indonesia","site_count":6,"avg_performance":30.3,"avg_accessibility":87.5,"avg_best_practices":73.7,"avg_seo":92.2,"avg_pwa":36.7,"best_performance":40,"worst_performance":25},{"country":"Singapore","site_count":6,"avg_performance":30,"avg_accessibility":83,"avg_best_practices":77.7,"avg_seo":84.5,"avg_pwa":33,"best_performance":56,"worst_performance":20}],
                'North America': [{"country":"Mexico","site_count":5,"avg_performance":58.8,"avg_accessibility":93.2,"avg_best_practices":88.2,"avg_seo":92.8,"avg_pwa":33,"best_performance":94,"worst_performance":26},{"country":"United States","site_count":124,"avg_performance":42,"avg_accessibility":88,"avg_best_practices":79.8,"avg_seo":89.4,"avg_pwa":38.6,"best_performance":100,"worst_performance":0},{"country":"Canada","site_count":23,"avg_performance":37.6,"avg_accessibility":93.3,"avg_best_practices":67,"avg_seo":87.8,"avg_pwa":42.3,"best_performance":85,"worst_performance":13}],
                'South America': [{"country":"Bolivia","site_count":4,"avg_performance":67.8,"avg_accessibility":84.8,"avg_best_practices":93.8,"avg_seo":91.8,"avg_pwa":35.8,"best_performance":98,"worst_performance":27},{"country":"Uruguay","site_count":4,"avg_performance":56.5,"avg_accessibility":75.3,"avg_best_practices":81.3,"avg_seo":91.8,"avg_pwa":35.8,"best_performance":80,"worst_performance":29},{"country":"Brazil","site_count":10,"avg_performance":40.8,"avg_accessibility":86.5,"avg_best_practices":79.2,"avg_seo":89.9,"avg_pwa":48.7,"best_performance":66,"worst_performance":2},{"country":"Paraguay","site_count":3,"avg_performance":40.3,"avg_accessibility":92.3,"avg_best_practices":80.3,"avg_seo":95,"avg_pwa":55.7,"best_performance":50,"worst_performance":32},{"country":"Argentina","site_count":5,"avg_performance":36.8,"avg_accessibility":91.6,"avg_best_practices":75,"avg_seo":92.4,"avg_pwa":35.2,"best_performance":67,"worst_performance":5},{"country":"Chile","site_count":8,"avg_performance":30,"avg_accessibility":80.9,"avg_best_practices":77,"avg_seo":88.6,"avg_pwa":31.6,"best_performance":59,"worst_performance":6}],
                'Africa': [{"country":"Zambia","site_count":9,"avg_performance":55,"avg_accessibility":90.1,"avg_best_practices":79.6,"avg_seo":85.2,"avg_pwa":30.7,"best_performance":99,"worst_performance":13},{"country":"Morocco","site_count":9,"avg_performance":44.6,"avg_accessibility":82.6,"avg_best_practices":74.1,"avg_seo":87.9,"avg_pwa":36.8,"best_performance":87,"worst_performance":0},{"country":"Namibia","site_count":6,"avg_performance":43.7,"avg_accessibility":83.2,"avg_best_practices":83.2,"avg_seo":85.3,"avg_pwa":33,"best_performance":61,"worst_performance":26},{"country":"Egypt","site_count":8,"avg_performance":38.8,"avg_accessibility":85.8,"avg_best_practices":67.6,"avg_seo":91.1,"avg_pwa":45.8,"best_performance":64,"worst_performance":16},{"country":"South Africa","site_count":8,"avg_performance":36.5,"avg_accessibility":88,"avg_best_practices":80.3,"avg_seo":85.8,"avg_pwa":51.3,"best_performance":89,"worst_performance":5},{"country":"Kenya","site_count":6,"avg_performance":35.5,"avg_accessibility":87.7,"avg_best_practices":76.3,"avg_seo":87.2,"avg_pwa":33,"best_performance":45,"worst_performance":27}],
                'Middle East': [{"country":"Iran","site_count":9,"avg_performance":65.2,"avg_accessibility":85.7,"avg_best_practices":73.1,"avg_seo":89.3,"avg_pwa":34.3,"best_performance":99,"worst_performance":32},{"country":"Libya","site_count":5,"avg_performance":53.2,"avg_accessibility":89.4,"avg_best_practices":85,"avg_seo":87.4,"avg_pwa":33,"best_performance":76,"worst_performance":26},{"country":"Israel","site_count":10,"avg_performance":40.4,"avg_accessibility":71.9,"avg_best_practices":77.4,"avg_seo":88.9,"avg_pwa":35.2,"best_performance":87,"worst_performance":28},{"country":"Saudi Arabia","site_count":9,"avg_performance":37.7,"avg_accessibility":83.3,"avg_best_practices":63.8,"avg_seo":86.2,"avg_pwa":39.3,"best_performance":57,"worst_performance":25},{"country":"United Arab Emirates","site_count":8,"avg_performance":24.9,"avg_accessibility":82.9,"avg_best_practices":69.8,"avg_seo":84.4,"avg_pwa":42.9,"best_performance":39,"worst_performance":6}],
                'Oceania': [{"country":"New Zealand","site_count":6,"avg_performance":49.7,"avg_accessibility":83.7,"avg_best_practices":57,"avg_seo":86,"avg_pwa":48.2,"best_performance":90,"worst_performance":27},{"country":"Australia","site_count":8,"avg_performance":47.1,"avg_accessibility":66.9,"avg_best_practices":86.4,"avg_seo":93,"avg_pwa":47.1,"best_performance":61,"worst_performance":32}]
            };

            // Calculate regional averages
            const regionalAverages = Object.entries(regionCountryData).map(([region, countries]) => ({
                region,
                average: countries.length > 0 ? countries.reduce((sum, c) => sum + c.avg_performance, 0) / countries.length : 0,
                count: countries.length
            })).filter(r => r.count > 0);

            // Sort by performance (highest first) and calculate differences from median
            const sortedRegions = regionalAverages.sort((a, b) => b.average - a.average);
            const medianIndex = Math.floor(sortedRegions.length / 2);
            const medianScore = sortedRegions[medianIndex].average;
            
            let currentView = 'regional'; // Track current view: 'regional' or region name
            let regionalChart = null;

            function createRegionalChart() {
                const regionLabels = sortedRegions.map(r => r.region);
                const differences = sortedRegions.map(r => r.average - medianScore);

                const config = {
                    type: 'bar',
                    data: {
                        labels: regionLabels,
                        datasets: [{
                            label: 'Performance Difference',
                            data: differences,
                            backgroundColor: differences.map(diff => diff > 0 ? '#10B981' : diff < 0 ? '#EF4444' : '#6B7280'),
                            borderColor: differences.map(diff => diff > 0 ? '#059669' : diff < 0 ? '#DC2626' : '#4B5563'),
                            borderWidth: 1
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        },
                        plugins: {
                            title: {
                                display: true,
                                text: 'Regional Performance vs Median (Click to explore countries)'
                            },
                            legend: { display: false },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const diff = context.parsed.x;
                                        const actualScore = medianScore + diff;
                                        if (diff === 0) {
                                            return context.label + ': ' + actualScore.toFixed(1) + ' (median)';
                                        } else {
                                            const sign = diff > 0 ? '+' : '';
                                            return context.label + ': ' + actualScore.toFixed(1) + ' (' + sign + diff.toFixed(1) + ' vs median)';
                                        }
                                    },
                                    afterLabel: function() {
                                        return 'Click to see countries in this region';
                                    }
                                }
                            }
                        },
                        onClick: function(event, elements) {
                            if (elements.length > 0) {
                                const elementIndex = elements[0].index;
                                const regionName = regionLabels[elementIndex];
                                showCountriesInRegion(regionName);
                            }
                        },
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Performance Difference from Median Region'
                                },
                                grid: {
                                    color: function(context) {
                                        return context.tick.value === 0 ? '#374151' : '#E5E7EB';
                                    }
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'Region'
                                }
                            }
                        }
                    }
                };

                if (regionalChart) {
                    regionalChart.destroy();
                }
                regionalChart = new Chart(regionalAnalysisCtx, config);
                currentView = 'regional';
            }

            function showCountriesInRegion(regionName) {
                const countries = regionCountryData[regionName];
                if (!countries || countries.length === 0) return;

                // Sort countries by performance and calculate differences from region median
                const sortedCountries = countries.sort((a, b) => b.avg_performance - a.avg_performance);
                const regionMedianIndex = Math.floor(sortedCountries.length / 2);
                const regionMedianScore = sortedCountries[regionMedianIndex].avg_performance;

                const countryLabels = sortedCountries.map(c => c.country);
                const countryDifferences = sortedCountries.map(c => c.avg_performance - regionMedianScore);

                const config = {
                    type: 'bar',
                    data: {
                        labels: countryLabels,
                        datasets: [{
                            label: 'Performance Difference',
                            data: countryDifferences,
                            backgroundColor: countryDifferences.map(diff => diff > 0 ? '#10B981' : diff < 0 ? '#EF4444' : '#6B7280'),
                            borderColor: countryDifferences.map(diff => diff > 0 ? '#059669' : diff < 0 ? '#DC2626' : '#4B5563'),
                            borderWidth: 1
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: regionName + ' Countries vs Regional Median'
                            },
                            legend: { display: false },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const diff = context.parsed.x;
                                        const actualScore = regionMedianScore + diff;
                                        if (diff === 0) {
                                            return context.label + ': ' + actualScore.toFixed(1) + ' (regional median)';
                                        } else {
                                            const sign = diff > 0 ? '+' : '';
                                            return context.label + ': ' + actualScore.toFixed(1) + ' (' + sign + diff.toFixed(1) + ' vs regional median)';
                                        }
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Performance Difference from Regional Median'
                                },
                                grid: {
                                    color: function(context) {
                                        return context.tick.value === 0 ? '#374151' : '#E5E7EB';
                                    }
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'Country'
                                }
                            }
                        }
                    }
                };

                if (regionalChart) {
                    regionalChart.destroy();
                }
                regionalChart = new Chart(regionalAnalysisCtx, config);
                currentView = regionName;

                // Add back button
                addBackButton();
            }

            function addBackButton() {
                // Remove existing back button if any
                const existingBtn = document.getElementById('regionalBackBtn');
                if (existingBtn) {
                    existingBtn.remove();
                }

                // Create back button
                const backBtn = document.createElement('button');
                backBtn.id = 'regionalBackBtn';
                backBtn.innerHTML = '‚Üê Back to Regional View';
                backBtn.style.cssText = 'margin-top: 10px; padding: 8px 16px; background: #3B82F6; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;';
                backBtn.onclick = function() {
                    createRegionalChart();
                    backBtn.remove();
                };

                // Insert after the chart container
                const chartSection = regionalAnalysisCtx.closest('.chart-section');
                if (chartSection) {
                    chartSection.appendChild(backBtn);
                }
            }

            // Initialize with regional view
            createRegionalChart();
        }
    </script>
    <!-- PostHog Analytics -->
    <script>
        !function(t,e){var o,n,p,r;e.__SV||(window.posthog && window.posthog.__loaded)||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.crossOrigin="anonymous",p.async=!0,p.src=s.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="init yi Ar jr mi Or Mr capture Li calculateEventProperties Nr register register_once register_for_session unregister unregister_for_session Br getFeatureFlag getFeatureFlagPayload isFeatureEnabled reloadFeatureFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on onFeatureFlags onSurveysLoaded onSessionId getSurveys getActiveMatchingSurveys renderSurvey displaySurvey canRenderSurvey canRenderSurveyAsync identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException loadToolbar get_property getSessionProperty zr Lr createPersonProfile Hr Rr qr opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing get_explicit_consent_status is_capturing clear_opt_in_out_capturing Dr debug L Ur getPageViewId captureTraceFeedback captureTraceMetric Pr".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
        posthog.init('phc_txSL3d2o8C7Y5fzys73cLBx88FYqcThmBOQ4XiIObgh', {
            api_host: 'https://us.i.posthog.com',
            defaults: '2025-05-24',
            person_profiles: 'identified_only'
        });
    </script>
</body>
</html>